<nav class="bg-blue-600 shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
        <div class="flex justify-between items-center h-16">
            <!-- Logo -->
            <div class="flex items-center">
                <a href="/" class="flex items-center space-x-2">
                    <i class="fas fa-hands-helping text-white text-2xl"></i>
                    <span class="text-white font-bold text-xl">Samyukt</span>
                </a>
            </div>

            <!-- Navigation Links -->
            <div class="hidden md:flex items-center space-x-8">
                <a href="/" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">Home</a>
                
                <!-- These will be controlled by JavaScript -->
                <a href="/user/dashboard" id="user-dashboard-link" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium hidden">Dashboard</a>
                <a href="/user/complaints/create" id="file-complaint-link" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium hidden">File Complaint</a>
                <a href="/resolver/dashboard" id="resolver-dashboard-link" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium hidden">Resolver Dashboard</a>
                

            <!-- User Menu -->
            <div class="flex items-center space-x-4">
                <!-- Logged out state (default) -->
                <div id="guest-menu" class="flex space-x-2">
                    <a href="/auth/login" class="text-blue-600 bg-white hover:bg-blue-50 px-4 py-2 rounded-md text-sm font-medium">Login</a>
                    <a href="/auth/register" class="text-white bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-md text-sm font-medium">Register</a>
                </div>

                <!-- Logged in state (hidden by default) -->
                <div id="user-menu" class="hidden">
                    <div class="relative group">
                        <button class="flex items-center space-x-2 text-white focus:outline-none">
                            <i class="fas fa-user-circle text-xl"></i>
                            <span class="hidden md:block" id="user-name">Guest</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 hidden group-hover:block">
                            <a href="/profile" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50">Profile</a>
                            <a href="#" onclick="logout()" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50">Logout</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile menu button -->
            <div class="md:hidden">
                <button type="button" id="mobile-menu-button" class="text-white hover:text-blue-200 focus:outline-none">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden pb-4">
            <div class="flex flex-col space-y-2">
                <a href="/" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">Home</a>
                
                <!-- Mobile links controlled by JS -->
                <a href="/user/dashboard" id="mobile-user-dashboard-link" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium hidden">Dashboard</a>
                <a href="/user/complaints/create" id="mobile-file-complaint-link" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium hidden">File Complaint</a>
                <a href="/resolver/dashboard" id="mobile-resolver-dashboard-link" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium hidden">Resolver Dashboard</a>
                <a href="/about" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">About</a>
                
                <!-- Mobile auth links -->
                <div id="mobile-guest-menu">
                    <a href="/auth/login" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">Login</a>
                    <a href="/auth/register" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">Register</a>
                </div>
                
                <div id="mobile-user-menu" class="hidden">
                    <a href="/profile" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">Profile</a>
                    <a href="#" onclick="logout()" class="text-white hover:text-blue-200 px-3 py-2 rounded-md text-sm font-medium">Logout</a>
                </div>
            </div>
        </div>
    </div>
</nav>

<script>
    // User state management
    const UserState = {
        role: localStorage.getItem('userRole') || 'none',
        name: localStorage.getItem('userName') || 'Guest',
        
        setUser(role, name) {
            this.role = role;
            this.name = name;
            localStorage.setItem('userRole', role);
            localStorage.setItem('userName', name);
            this.updateUI();
        },
        
        clearUser() {
            this.role = 'none';
            this.name = 'Guest';
            localStorage.removeItem('userRole');
            localStorage.removeItem('userName');
            this.updateUI();
        },
        
        updateUI() {
            const guestMenu = document.getElementById('guest-menu');
            const userMenu = document.getElementById('user-menu');
            const mobileGuestMenu = document.getElementById('mobile-guest-menu');
            const mobileUserMenu = document.getElementById('mobile-user-menu');
            
            const userDashboardLink = document.getElementById('user-dashboard-link');
            const fileComplaintLink = document.getElementById('file-complaint-link');
            const resolverDashboardLink = document.getElementById('resolver-dashboard-link');
            const aboutLink = document.getElementById('about-link');
            
            const mobileUserDashboardLink = document.getElementById('mobile-user-dashboard-link');
            const mobileFileComplaintLink = document.getElementById('mobile-file-complaint-link');
            const mobileResolverDashboardLink = document.getElementById('mobile-resolver-dashboard-link');
            
            const userNameElement = document.getElementById('user-name');

            // Reset all
            guestMenu.style.display = 'flex';
            userMenu.style.display = 'none';
            mobileGuestMenu.style.display = 'block';
            mobileUserMenu.style.display = 'none';
            
            userDashboardLink.classList.add('hidden');
            fileComplaintLink.classList.add('hidden');
            resolverDashboardLink.classList.add('hidden');
            aboutLink.classList.remove('hidden');
            
            mobileUserDashboardLink.classList.add('hidden');
            mobileFileComplaintLink.classList.add('hidden');
            mobileResolverDashboardLink.classList.add('hidden');

            if (this.role !== 'none') {
                guestMenu.style.display = 'none';
                userMenu.style.display = 'flex';
                mobileGuestMenu.style.display = 'none';
                mobileUserMenu.style.display = 'block';
                
                if (userNameElement) {
                    userNameElement.textContent = this.name;
                }

                if (this.role === 'user') {
                    userDashboardLink.classList.remove('hidden');
                    fileComplaintLink.classList.remove('hidden');
                    mobileUserDashboardLink.classList.remove('hidden');
                    mobileFileComplaintLink.classList.remove('hidden');
                } else if (this.role === 'resolver') {
                    resolverDashboardLink.classList.remove('hidden');
                    mobileResolverDashboardLink.classList.remove('hidden');
                }
            }
        }
    };

    // Initialize UI on page load
    document.addEventListener('DOMContentLoaded', function() {
        UserState.updateUI();
        
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    });

    // Logout function
    function logout() {
        UserState.clearUser();
        window.location.href = '/';
    }

    // Demo login functions (for testing)
    function demoLoginAsUser() {
        UserState.setUser('user', 'Rahul Sharma');
        alert('Logged in as Citizen: Rahul Sharma');
    }

    function demoLoginAsResolver() {
        UserState.setUser('resolver', 'Municipal Corporation');
        alert('Logged in as Resolver: Municipal Corporation');
    }
</script>